<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é»˜å¥‘å¤§è€ƒé©— | Stella & Kevin</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;900&family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Config & Styles -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        morandi: {
                            bg: '#F5F5F3',       /* æº«æš–ç±³ç° */
                            card: '#FFFFFF',
                            primary: '#7A8B8B',  /* éœ§ç°ç¶  */
                            secondary: '#B59F9F',/* è—•ç²‰è‰² */
                            accent: '#A6A58D',   /* ä¹¾è‰ç¶  */
                            text: '#4A4A4A',     /* æ·±ç° */
                            light: '#9E9E9E'
                        }
                    },
                    fontFamily: {
                        sans: ['Noto Sans TC', 'sans-serif'],
                        serif: ['Noto Serif TC', 'serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #F5F5F3; }
        .fade-enter { opacity: 0; transform: translateY(10px); }
        .fade-enter-active { opacity: 1; transform: translateY(0); transition: opacity 300ms, transform 300ms; }
        .slide-up { animation: slideUp 0.5s ease-out forwards; }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --------------------------------------------------
        // è³‡æ–™åº«ï¼šåŸºæ–¼ä¸Šå‚³çš„å°è©±ç´€éŒ„æå–
        // --------------------------------------------------
        const DEFAULT_QUESTIONS = [
            { id: 1, type: "fact", question: "12æœˆ13æ—¥æ—©ä¸Šï¼ŒStella ç™¼ç”Ÿäº†ä»€éº¼ç·Šæ€¥ç‹€æ³ï¼Ÿ", options: ["å¿˜è¨˜å¸¶éŒ¢åŒ…", "å¿˜è¨˜å¸¶é‘°åŒ™", "è»Šå­ç™¼ä¸å‹•", "ç¡éé ­é²åˆ°"], answer: "å¿˜è¨˜å¸¶é‘°åŒ™" },
            { id: 2, type: "habit", question: "å…©äººçš„å°è©±ä¸­ï¼Œæœ€å¸¸å‡ºç¾çš„ã€Œç‹€è²è©ã€æˆ–å£é ­ç¦ªæ˜¯ä»€éº¼ï¼Ÿ", options: ["å“ˆå›‰", "é€¼ (Bii)", "å˜¿", "å–‚"], answer: "é€¼ (Bii)" },
            { id: 3, type: "nickname", question: "Stella æœ€å¸¸ç”¨å“ªç¨®å‹•ç‰©ä¾†ç¨±å‘¼è‡ªå·±æˆ–å°æ–¹ï¼Ÿ", options: ["è²“å’ª", "ç‹—ç‹—", "çš®å¡ä¸˜/èƒ–ä¸˜", "å°è±¬"], answer: "çš®å¡ä¸˜/èƒ–ä¸˜" },
            { id: 4, type: "fact", question: "Stella æ›¾ç¶“å› ç‚ºä»€éº¼äº‹æƒ…åœ¨ã€Œè–‘æ¯é´¨åº—ã€å¤§å“­ï¼Ÿ", options: ["å¤ªå¥½åƒ", "å‡±æ™¨ä¸åƒé´¨è‚‰", "ç’°å¢ƒå¤ªåµé›œ", "è¢«æ¹¯ç‡™åˆ°"], answer: "ç’°å¢ƒå¤ªåµé›œ" },
            { id: 5, type: "preference", question: "é—œæ–¼å·¥ä½œï¼ŒStella æœ€è¨å­å‰å…¬å¸ï¼ˆå°éŠ€ï¼‰çš„å“ªå€‹éƒ¨åˆ†ï¼Ÿ", options: ["å¥§å®¢å¤ªå¤š", "å°å¸³å–®èˆ‡æ­¸æª”", "åˆ¶æœå¾ˆé†œ", "æ²’æœ‰åˆä¼‘"], answer: "å°å¸³å–®èˆ‡æ­¸æª”" },
            { id: 6, type: "fact", question: "å‡±æ™¨æ›¾ç¶“é€éä»€éº¼ã€Œé«˜ç§‘æŠ€ã€ä½†è¢« Stella å«Œæ£„ä¸å¯¦ç”¨çš„ç¦®ç‰©ï¼Ÿ", options: ["æƒåœ°æ©Ÿå™¨äºº", "æ™ºæ…§åƒåœ¾æ¡¶ (iTrash)", "ç©ºæ‹æ©Ÿ", "é›»å­æ›¸"], answer: "æ™ºæ…§åƒåœ¾æ¡¶ (iTrash)" },
            { id: 7, type: "fact", question: "ä»–å€‘åŸå®šè¨ˆç•«å»å“ªå€‹åœ‹å®¶æ—…éŠï¼Ÿ", options: ["æ—¥æœ¬", "éŸ“åœ‹", "æ¾³æ´²", "æ³°åœ‹"], answer: "æ¾³æ´²" },
            { id: 8, type: "fact", question: "èª°çš„é›»è…¦è™•ç†å™¨æ˜¯ç¬¬ 9 ä»£ï¼Œè¢«è¨è«–åˆ°æ•ˆèƒ½å•é¡Œï¼Ÿ", options: ["Stella", "é»ƒå‡±æ™¨", "å…¬å¸é›»è…¦", "å®¶è£¡çš„é›»è¦–"], answer: "é»ƒå‡±æ™¨" },
            { id: 9, type: "food", question: "ä»–å€‘å¸¸ä¸€èµ·åƒçš„æ—©é¤åº—å«ä»€éº¼åå­—ï¼Ÿ", options: ["ç¾è€Œç¾", "æ˜¥ç±³", "æ‹‰äº", "éº¥å‘³ç™»"], answer: "æ˜¥ç±³" },
            { id: 10, type: "fact", question: "Stella æåˆ°è¾¦å…¬å®¤æœ‰ä»€éº¼é»å¿ƒæ™‚ï¼Œèªªäº†ã€Œå·²åƒã€ï¼Ÿ", options: ["é³³æ¢¨é…¥", "é»‘ç³–ç³•", "å¤ªé™½é¤…", "è›‹å¡”"], answer: "é»‘ç³–ç³•" },
            { id: 11, type: "fact", question: "åœ¨è‚¡ç¥¨æ“ä½œä¸Šï¼ŒStella è‡ªå˜²æ˜¯ä»€éº¼èº«åˆ†ï¼Ÿ", options: ["è¯çˆ¾è¡—ä¹‹ç‹¼", "ç•¶æ²–å¥³ç‹", "ç©ºè›™/å®¶æ”¿å©¦", "é•·æœŸæŠ•è³‡è€…"], answer: "ç©ºè›™/å®¶æ”¿å©¦" },
            { id: 12, type: "fact", question: "Stella æ›¾ç¶“è€ƒæ…®å»å“ªå€‹è¨ºæ‰€/æ©Ÿæ§‹å·¥ä½œï¼Ÿ", options: ["é¦™æŸæœ¨", "æ„›ä»", "å¤§å­¸çœ¼ç§‘", "ç¦¾é¦¨"], answer: "é¦™æŸæœ¨" },
            { id: 13, type: "preference", question: "Stella è¦ºå¾—å“ªå®¶éŠ€è¡Œçš„ç³»çµ±å¾ˆçˆ›ï¼Œå¸¸æœ‰ Bugï¼Ÿ", options: ["å°éŠ€", "ä¸­ä¿¡", "æ˜Ÿå±•", "å¯Œé‚¦"], answer: "æ˜Ÿå±•" },
            { id: 14, type: "fact", question: "èª°æ›¾ç¶“å› ç‚ºé•è¦åœè»Šè¢«é–‹ç½°å–®ï¼Ÿ", options: ["Stella", "é»ƒå‡±æ™¨", "å…©å€‹äººéƒ½å› ç‚ºé€™æ¨£è¢«ç½°", "æ²’æœ‰äºº"], answer: "é»ƒå‡±æ™¨" },
            { id: 15, type: "food", question: "Stella è¦ºå¾—å“ªä¸€å®¶çš„çç é®®å¥¶èŒ¶ã€Œåƒæ°´ä¸€æ¨£ã€å¾ˆé›£å–ï¼Ÿ", options: ["50åµ", "è¬å®¶é¦™æ—©é¤åº—", "è¿·å®¢å¤", "å¯ä¸å¯"], answer: "è¬å®¶é¦™æ—©é¤åº—" }
        ];

        // --------------------------------------------------
        // å…ƒä»¶ï¼šSVG Icons
        // --------------------------------------------------
        const HeartIcon = () => (
            <svg className="w-6 h-6 text-morandi-secondary fill-current" viewBox="0 0 24 24">
                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
            </svg>
        );

        const UploadIcon = () => (
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
            </svg>
        );

        // --------------------------------------------------
        // ä¸»æ‡‰ç”¨ç¨‹å¼
        // --------------------------------------------------
        function App() {
            // ç‹€æ…‹ç®¡ç†
            const [gameStage, setGameStage] = useState('welcome'); // welcome, p1_turn, intermission, p2_turn, calculating, result
            const [p1Name, setP1Name] = useState('åº­æš„ Stella');
            const [p2Name, setP2Name] = useState('é»ƒå‡±æ™¨');
            const [questions, setQuestions] = useState(DEFAULT_QUESTIONS);
            const [currentQIndex, setCurrentQIndex] = useState(0);
            
            // ç­”æ¡ˆå„²å­˜: { questionId: selectedOption }
            const [p1Answers, setP1Answers] = useState({});
            const [p2Answers, setP2Answers] = useState({});

            // éš¨æ©Ÿé¸é¡Œ (æ¯æ¬¡éŠæˆ²å– 10 é¡Œ)
            const initGame = () => {
                const shuffled = [...questions].sort(() => 0.5 - Math.random()).slice(0, 10);
                setQuestions(shuffled);
                setCurrentQIndex(0);
                setP1Answers({});
                setP2Answers({});
                setGameStage('p1_turn');
            };

            // è™•ç†å›ç­”
            const handleAnswer = (option) => {
                const currentQ = questions[currentQIndex];
                
                if (gameStage === 'p1_turn') {
                    setP1Answers(prev => ({ ...prev, [currentQ.id]: option }));
                } else {
                    setP2Answers(prev => ({ ...prev, [currentQ.id]: option }));
                }

                // å»¶é²è·³è½‰
                setTimeout(() => {
                    if (currentQIndex < questions.length - 1) {
                        setCurrentQIndex(prev => prev + 1);
                    } else {
                        // ç•¶å‰ç©å®¶é¡Œç›®åšå®Œ
                        if (gameStage === 'p1_turn') {
                            setGameStage('intermission');
                            setCurrentQIndex(0);
                        } else {
                            setGameStage('calculating');
                            setTimeout(() => setGameStage('result'), 2000);
                        }
                    }
                }, 400);
            };

            // è¨ˆç®—åˆ†æ•¸
            const calculateResult = () => {
                let score = 0;
                let details = [];

                questions.forEach(q => {
                    const ans1 = p1Answers[q.id];
                    const ans2 = p2Answers[q.id];
                    const correct = q.answer;
                    
                    // é‚è¼¯ï¼šå…©äººéƒ½ç­”å°æ‰ç®—é€™é¡Œæœ‰é»˜å¥‘/æœ‰è¨˜æ†¶
                    // æˆ–è€…ï¼šå…©äººéƒ½é¸ä¸€æ¨£çš„ç­”æ¡ˆï¼ˆå³ä½¿æ˜¯éŒ¯çš„ï¼Œä»£è¡¨é€™ä¹Ÿæ˜¯ä¸€ç¨®é»˜å¥‘ï¼‰
                    const isMatch = ans1 === ans2;
                    const isCorrect = ans1 === correct && ans2 === correct;
                    
                    if (isMatch) score += 10;

                    details.push({
                        question: q.question,
                        ans1,
                        ans2,
                        correct,
                        isMatch
                    });
                });

                return { score, details };
            };

            // æ¸²æŸ“ï¼šæ­¡è¿é é¢
            if (gameStage === 'welcome') {
                return (
                    <div className="min-h-screen flex flex-col items-center justify-center p-6 bg-gradient-to-br from-[#F5F5F3] to-[#E8E6E1]">
                        <div className="glass-card w-full max-w-md p-8 rounded-3xl shadow-xl text-center slide-up">
                            <div className="flex justify-center mb-6">
                                <div className="bg-morandi-secondary/20 p-4 rounded-full">
                                    <HeartIcon />
                                </div>
                            </div>
                            <h1 className="text-3xl font-serif font-bold text-morandi-text mb-2">é»˜å¥‘å¤§è€ƒé©—</h1>
                            <p className="text-morandi-primary mb-8 text-sm tracking-widest">RELATIONSHIP QUIZ</p>
                            
                            <div className="space-y-4 mb-8 text-left">
                                <div>
                                    <label className="text-xs text-morandi-light font-bold uppercase tracking-wider ml-1">Player 1</label>
                                    <input 
                                        type="text" 
                                        value={p1Name} 
                                        onChange={(e) => setP1Name(e.target.value)}
                                        className="w-full mt-1 p-3 bg-white border border-gray-200 rounded-xl focus:outline-none focus:border-morandi-primary text-morandi-text"
                                    />
                                </div>
                                <div>
                                    <label className="text-xs text-morandi-light font-bold uppercase tracking-wider ml-1">Player 2</label>
                                    <input 
                                        type="text" 
                                        value={p2Name} 
                                        onChange={(e) => setP2Name(e.target.value)}
                                        className="w-full mt-1 p-3 bg-white border border-gray-200 rounded-xl focus:outline-none focus:border-morandi-primary text-morandi-text"
                                    />
                                </div>
                            </div>

                            <button 
                                onClick={initGame}
                                className="w-full py-4 bg-morandi-primary text-white rounded-xl font-bold shadow-lg hover:bg-[#6A7B7B] transition-all transform hover:-translate-y-1 mb-4"
                            >
                                é–‹å§‹æ¸¬é©—
                            </button>
                            
                            <p className="text-xs text-morandi-light mt-4">
                                æ ¹æ“šä¸Šå‚³çš„å°è©±ç´€éŒ„è‡ªå‹•ç”Ÿæˆ<br/>
                                åŒ…å«ç”Ÿæ´»è¶£äº‹ã€ç¿’æ…£ç”¨èªèˆ‡å…±åŒå›æ†¶
                            </p>
                        </div>
                    </div>
                );
            }

            // æ¸²æŸ“ï¼šä¸­å ´ä¼‘æ¯ï¼ˆæ›äººï¼‰
            if (gameStage === 'intermission') {
                return (
                    <div className="min-h-screen flex flex-col items-center justify-center p-6 bg-morandi-primary/10">
                        <div className="glass-card w-full max-w-md p-10 rounded-3xl shadow-xl text-center slide-up">
                            <h2 className="text-2xl font-bold text-morandi-text mb-4">{p1Name} ä½œç­”å®Œæˆï¼</h2>
                            <p className="text-morandi-text/80 mb-8 leading-relaxed">
                                è«‹å°‡æ‰‹æ©Ÿ/é›»è…¦äº¤çµ¦ <span className="font-bold text-morandi-primary">{p2Name}</span><br/>
                                æ¥ä¸‹ä¾†æ›ä»–æ¥å—æŒ‘æˆ°ã€‚
                            </p>
                            <div className="w-20 h-20 bg-white rounded-full mx-auto mb-8 flex items-center justify-center shadow-inner">
                                <span className="text-3xl">ğŸ¤«</span>
                            </div>
                            <button 
                                onClick={() => setGameStage('p2_turn')}
                                className="w-full py-4 bg-morandi-secondary text-white rounded-xl font-bold shadow-lg hover:opacity-90 transition-all"
                            >
                                æˆ‘æ˜¯ {p2Name}ï¼Œé–‹å§‹ä½œç­”
                            </button>
                        </div>
                    </div>
                );
            }

            // æ¸²æŸ“ï¼šè¨ˆç®—ä¸­
            if (gameStage === 'calculating') {
                return (
                    <div className="min-h-screen flex flex-col items-center justify-center p-6">
                        <div className="text-center">
                            <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-morandi-primary mx-auto mb-4"></div>
                            <p className="text-morandi-text font-serif text-xl">æ­£åœ¨åˆ†æå…©äººé»˜å¥‘...</p>
                        </div>
                    </div>
                );
            }

            // æ¸²æŸ“ï¼šçµæœé 
            if (gameStage === 'result') {
                const { score, details } = calculateResult();
                return (
                    <div className="min-h-screen p-4 md:p-8 bg-[#F5F5F3]">
                        <div className="max-w-2xl mx-auto space-y-6">
                            {/* ç¸½åˆ†å¡ç‰‡ */}
                            <div className="glass-card p-8 rounded-3xl shadow-lg text-center slide-up relative overflow-hidden">
                                <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-morandi-primary to-morandi-secondary"></div>
                                <h2 className="text-morandi-light text-sm tracking-widest uppercase mb-2">Matching Score</h2>
                                <div className="text-7xl font-serif font-bold text-morandi-text mb-2">{score}%</div>
                                <p className="text-morandi-primary font-medium">
                                    {score === 100 ? "éˆé­‚ä¼´ä¾¶ï¼çš®å¡ä¸˜éƒ½é©šå‘†äº†ï¼" : 
                                     score >= 80 ? "è¶…ç´šæœ‰é»˜å¥‘ï¼æ ¹æœ¬æ˜¯è€å¤«è€å¦»" :
                                     score >= 60 ? "é‚„ä¸éŒ¯å–”ï¼Œä½†æœ‰äº›å›æ†¶éœ€è¦è¤‡ç¿’" :
                                     "çœ‹ä¾†éœ€è¦å¤šå»åƒå¹¾æ¬¡æ˜¥ç±³åŸ¹é¤Šæ„Ÿæƒ…äº† XD"}
                                </p>
                            </div>

                            {/* è©³ç´°æ¯”å° */}
                            <div className="space-y-4">
                                <h3 className="text-morandi-text font-bold ml-2">ç­”é¡Œè©³æƒ…</h3>
                                {details.map((item, idx) => (
                                    <div key={idx} className={`bg-white p-5 rounded-2xl shadow-sm border-l-4 ${item.isMatch ? 'border-morandi-primary' : 'border-morandi-secondary'} slide-up`} style={{animationDelay: `${idx * 100}ms`}}>
                                        <p className="font-medium text-morandi-text mb-3 text-lg">{item.question}</p>
                                        <div className="grid grid-cols-2 gap-4 text-sm">
                                            <div className="bg-gray-50 p-3 rounded-lg">
                                                <span className="block text-xs text-gray-400 mb-1">{p1Name}</span>
                                                <span className={`${item.ans1 === item.correct ? 'text-morandi-primary font-bold' : 'text-gray-600'}`}>{item.ans1}</span>
                                            </div>
                                            <div className="bg-gray-50 p-3 rounded-lg">
                                                <span className="block text-xs text-gray-400 mb-1">{p2Name}</span>
                                                <span className={`${item.ans2 === item.correct ? 'text-morandi-primary font-bold' : 'text-gray-600'}`}>{item.ans2}</span>
                                            </div>
                                        </div>
                                        {!item.isMatch && (
                                            <div className="mt-3 pt-3 border-t border-gray-100 text-xs text-morandi-secondary">
                                                ğŸ’¡ ç­”æ¡ˆä¸ä¸€è‡´ï¼æ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š{item.correct}
                                            </div>
                                        )}
                                    </div>
                                ))}
                            </div>

                            <button 
                                onClick={() => setGameStage('welcome')}
                                className="w-full py-4 bg-white border border-morandi-primary text-morandi-primary rounded-xl font-bold hover:bg-morandi-primary hover:text-white transition-colors"
                            >
                                å†ç©ä¸€æ¬¡
                            </button>
                        </div>
                    </div>
                );
            }

            // æ¸²æŸ“ï¼šç­”é¡Œä¸­ (é€šç”¨ä»‹é¢)
            const currentQ = questions[currentQIndex];
            const currentPlayerName = gameStage === 'p1_turn' ? p1Name : p2Name;
            const progress = ((currentQIndex + 1) / questions.length) * 100;

            return (
                <div className="min-h-screen flex flex-col p-6 max-w-md mx-auto relative">
                    {/* é€²åº¦æ¢ */}
                    <div className="w-full bg-gray-200 h-1.5 rounded-full mb-8 fixed top-0 left-0 z-50">
                        <div className="bg-morandi-primary h-full transition-all duration-500" style={{ width: `${progress}%` }}></div>
                    </div>
                    
                    <div className="flex-1 flex flex-col justify-center slide-up">
                        <div className="mb-8">
                            <span className="inline-block px-3 py-1 bg-white border border-gray-200 rounded-full text-xs font-bold text-morandi-primary mb-4 shadow-sm">
                                Question {currentQIndex + 1} / {questions.length}
                            </span>
                            <span className="block text-xs text-gray-400 mb-2">æ­£åœ¨ä½œç­”: {currentPlayerName}</span>
                            <h2 className="text-2xl font-bold text-morandi-text leading-relaxed">
                                {currentQ.question}
                            </h2>
                        </div>

                        <div className="space-y-3">
                            {currentQ.options.map((opt, idx) => {
                                // åˆ¤æ–·æ˜¯å¦è¢«é¸ä¸­
                                const currentAnswers = gameStage === 'p1_turn' ? p1Answers : p2Answers;
                                const isSelected = currentAnswers[currentQ.id] === opt;
                                
                                return (
                                    <button
                                        key={idx}
                                        onClick={() => handleAnswer(opt)}
                                        className={`w-full p-5 text-left rounded-2xl transition-all duration-200 border 
                                            ${isSelected 
                                                ? 'bg-morandi-primary text-white border-morandi-primary shadow-lg scale-[1.02]' 
                                                : 'bg-white text-morandi-text border-gray-100 hover:border-morandi-primary/50 shadow-sm hover:bg-gray-50'
                                            }`}
                                    >
                                        <span className="text-base font-medium">{opt}</span>
                                    </button>
                                );
                            })}
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>